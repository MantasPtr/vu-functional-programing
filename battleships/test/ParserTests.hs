module ParserTests(parserTests) where

import Test.Tasty
import Test.Tasty.HUnit

import Data.List
import Data.Maybe
import Data.Either
import Structures
import MessageParser

parserTests :: TestTree
parserTests = testGroup "Parser test" 
    [
        testCase "Empty message error" $
            isLeft (process "") @?= True
        ,
        testCase "Empty list error" $
            isLeft (process "[]") @?= True
        ,
        testCase "Empty coordinates" $
            process "[\"coord\",[],\"result\",null,\"prev\",null]" @?= 
            formResult NewMessage {coord = Nothing, result = Nothing, prev = Nothing}
        ,
        testCase "First move" $ 
            process "[\"coord\",[\"F\",\"6\"],\"result\",null,\"prev\",null]" @?= 
            formResult NewMessage {coord = Just ("F","6"), result = Nothing, prev = Nothing}
        ,
        testCase "Second move" $ 
            process "[\"coord\",[\"A\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"6\"],\"result\",null,\"prev\",null]" @?= 
            formResult NewMessage {coord = Just ("A","4"), result = Just False, prev = Just NewMessage {coord = Just ("F","6"), result = Nothing, prev = Nothing}}
        ,
        testCase "Game over" $ 
            process "[\"coord\",[],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"1\"],\"result\",null,\"prev\",null]" @?= 
            formResult NewMessage {coord = Nothing, result = Just False, prev = Just NewMessage {coord = Just ("A","1"), result = Nothing, prev = Nothing}}
        ,
        testCase "A lot of moves" $ 
            process "[\"coord\",[\"C\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"8\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"I\",\"10\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"J\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"J\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"10\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"B\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"3\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"B\",\"1\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"3\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"B\",\"2\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"A\",\"10\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"B\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"8\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"I\",\"10\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"J\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"B\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"1\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"B\",\"4\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"10\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"G\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"3\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"A\",\"10\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"B\",\"7\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"A\",\"7\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"E\",\"6\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"B\",\"10\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"10\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"1\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"10\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"A\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"10\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"1\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"F\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"10\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"B\",\"10\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"2\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"B\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"J\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"6\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"A\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"B\",\"3\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"5\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"3\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"6\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"A\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"1\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"E\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"9\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"B\",\"6\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"B\",\"1\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"2\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"C\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"H\",\"5\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"B\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"B\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"B\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"10\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"J\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"A\",\"5\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"F\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"10\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"5\"],\"result\",\"HIT\",\"prev\",[\"coord\",[\"E\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"D\",\"2\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"7\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"F\",\"4\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"1\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"10\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"5\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"8\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"I\",\"6\"],\"result\",\"MISS\",\"prev\",[\"coord\",[\"G\",\"6\"],\"result\",null,\"prev\",null]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]"
            @?= 
            formResult NewMessage {coord = Just ("C","3"), result = Just False, prev = Just NewMessage {coord = Just ("A","4"), result = Just False, prev = Just NewMessage {coord = Just ("G","1"), result = Just False, prev = Just NewMessage {coord = Just ("G","9"), result = Just False, prev = Just NewMessage {coord = Just ("I","8"), result = Just True, prev = Just NewMessage {coord = Just ("I","10"), result = Just False, prev = Just NewMessage {coord = Just ("A","8"), result = Just False, prev = Just NewMessage {coord = Just ("J","5"), result = Just False, prev = Just NewMessage {coord = Just ("A","3"), result = Just False, prev = Just NewMessage {coord = Just ("J","9"), result = Just False, prev = Just NewMessage {coord = Just ("E","4"), result = Just False, prev = Just NewMessage {coord = Just ("F","9"), result = Just False, prev = Just NewMessage {coord = Just ("H","2"), result = Just False, prev = Just NewMessage {coord = Just ("I","8"), result = Just False, prev = Just NewMessage {coord = Just ("D","8"), result = Just False, prev = Just NewMessage {coord = Just ("C","9"), result = Just False, prev = Just NewMessage {coord = Just ("E","10"), result = Just False, prev = Just NewMessage {coord = Just ("B","8"), result = Just False, prev = Just NewMessage {coord = Just ("E","5"), result = Just False, prev = Just NewMessage {coord = Just ("F","3"), result = Just True, prev = Just NewMessage {coord = Just ("B","1"), result = Just True, prev = Just NewMessage {coord = Just ("J","3"), result = Just True, prev = Just NewMessage {coord = Just ("J","6"), result = Just False, prev = Just NewMessage {coord = Just ("C","4"), result = Just False, prev = Just NewMessage {coord = Just ("B","2"), result = Just True, prev = Just NewMessage {coord = Just ("A","10"), result = Just False, prev = Just NewMessage {coord = Just ("I","6"), result = Just False, prev = Just NewMessage {coord = Just ("B","5"), result = Just False, prev = Just NewMessage {coord = Just ("D","1"), result = Just False, prev = Just NewMessage {coord = Just ("A","8"), result = Just True, prev = Just NewMessage {coord = Just ("I","10"), result = Just False, prev = Just NewMessage {coord = Just ("H","2"), result = Just False, prev = Just NewMessage {coord = Just ("J","5"), result = Just False, prev = Just NewMessage {coord = Just ("E","4"), result = Just False, prev = Just NewMessage {coord = Just ("I","5"), result = Just False, prev = Just NewMessage {coord = Just ("I","2"), result = Just False, prev = Just NewMessage {coord = Just ("I","4"), result = Just False, prev = Just NewMessage {coord = Just ("E","7"), result = Just False, prev = Just NewMessage {coord = Just ("E","2"), result = Just False, prev = Just NewMessage {coord = Just ("H","8"), result = Just False, prev = Just NewMessage {coord = Just ("G","7"), result = Just False, prev = Just NewMessage {coord = Just ("G","7"), result = Just False, prev = Just NewMessage {coord = Just ("B","8"), result = Just False, prev = Just NewMessage {coord = Just ("E","3"), result = Just False, prev = Just NewMessage {coord = Just ("H","5"), result = Just False, prev = Just NewMessage {coord = Just ("C","7"), result = Just False, prev = Just NewMessage {coord = Just ("A","9"), result = Just False, prev = Just NewMessage {coord = Just ("A","3"), result = Just False, prev = Just NewMessage {coord = Just ("I","1"), result = Just True, prev = Just NewMessage {coord = Just ("B","4"), result = Just True, prev = Just NewMessage {coord = Just ("J","10"), result = Just True, prev = Just NewMessage {coord = Just ("G","3"), result = Just False, prev = Just NewMessage {coord = Just ("D","9"), result = Just False, prev = Just NewMessage {coord = Just ("D","3"), result = Just True, prev = Just NewMessage {coord = Just ("A","10"), result = Just True, prev = Just NewMessage {coord = Just ("J","8"), result = Just False, prev = Just NewMessage {coord = Just ("B","7"), result = Just True, prev = Just NewMessage {coord = Just ("A","7"), result = Just True, prev = Just NewMessage {coord = Just ("E","6"), result = Just True, prev = Just NewMessage {coord = Just ("B","10"), result = Just False, prev = Just NewMessage {coord = Just ("H","6"), result = Just False, prev = Just NewMessage {coord = Just ("C","2"), result = Just False, prev = Just NewMessage {coord = Just ("H","7"), result = Just False, prev = Just NewMessage {coord = Just ("G","6"), result = Just False, prev = Just NewMessage {coord = Just ("A","2"), result = Just False, prev = Just NewMessage {coord = Just ("E","8"), result = Just False, prev = Just NewMessage {coord = Just ("E","9"), result = Just False, prev = Just NewMessage {coord = Just ("D","4"), result = Just False, prev = Just NewMessage {coord = Just ("D","4"), result = Just False, prev = Just NewMessage {coord = Just ("H","6"), result = Just False, prev = Just NewMessage {coord = Just ("H","10"), result = Just False, prev = Just NewMessage {coord = Just ("H","1"), result = Just True, prev = Just NewMessage {coord = Just ("J","1"), result = Just False, prev = Just NewMessage {coord = Just ("I","3"), result = Just False, prev = Just NewMessage {coord = Just ("F","10"), result = Just True, prev = Just NewMessage {coord = Just ("A","1"), result = Just False, prev = Just NewMessage {coord = Just ("C","1"), result = Just False, prev = Just NewMessage {coord = Just ("E","10"), result = Just False, prev = Just NewMessage {coord = Just ("I","3"), result = Just False, prev = Just NewMessage {coord = Just ("D","8"), result = Just False, prev = Just NewMessage {coord = Just ("H","9"), result = Just False, prev = Just NewMessage {coord = Just ("A","2"), result = Just False, prev = Just NewMessage {coord = Just ("F","5"), result = Just False, prev = Just NewMessage {coord = Just ("D","1"), result = Just True, prev = Just NewMessage {coord = Just ("F","8"), result = Just False, prev = Just NewMessage {coord = Just ("F","4"), result = Just False, prev = Just NewMessage {coord = Just ("F","6"), result = Just False, prev = Just NewMessage {coord = Just ("G","10"), result = Just True, prev = Just NewMessage {coord = Just ("B","10"), result = Just False, prev = Just NewMessage {coord = Just ("A","5"), result = Just False, prev = Just NewMessage {coord = Just ("F","1"), result = Just False, prev = Just NewMessage {coord = Just ("I","4"), result = Just False, prev = Just NewMessage {coord = Just ("I","2"), result = Just True, prev = Just NewMessage {coord = Just ("J","7"), result = Just False, prev = Just NewMessage {coord = Just ("G","4"), result = Just False, prev = Just NewMessage {coord = Just ("B","9"), result = Just False, prev = Just NewMessage {coord = Just ("H","1"), result = Just False, prev = Just NewMessage {coord = Just ("F","1"), result = Just False, prev = Just NewMessage {coord = Just ("E","8"), result = Just False, prev = Just NewMessage {coord = Just ("E","9"), result = Just False, prev = Just NewMessage {coord = Just ("E","7"), result = Just False, prev = Just NewMessage {coord = Just ("F","7"), result = Just False, prev = Just NewMessage {coord = Just ("C","6"), result = Just False, prev = Just NewMessage {coord = Just ("H","3"), result = Just False, prev = Just NewMessage {coord = Just ("D","3"), result = Just False, prev = Just NewMessage {coord = Just ("D","2"), result = Just False, prev = Just NewMessage {coord = Just ("C","8"), result = Just False, prev = Just NewMessage {coord = Just ("E","2"), result = Just False, prev = Just NewMessage {coord = Just ("D","7"), result = Just False, prev = Just NewMessage {coord = Just ("C","1"), result = Just False, prev = Just NewMessage {coord = Just ("F","9"), result = Just False, prev = Just NewMessage {coord = Just ("C","3"), result = Just False, prev = Just NewMessage {coord = Just ("J","9"), result = Just False, prev = Just NewMessage {coord = Just ("G","8"), result = Just False, prev = Just NewMessage {coord = Just ("C","9"), result = Just False, prev = Just NewMessage {coord = Just ("F","6"), result = Just False, prev = Just NewMessage {coord = Just ("C","7"), result = Just False, prev = Just NewMessage {coord = Just ("H","9"), result = Just False, prev = Just NewMessage {coord = Just ("I","7"), result = Just False, prev = Just NewMessage {coord = Just ("C","6"), result = Just True, prev = Just NewMessage {coord = Just ("A","7"), result = Just False, prev = Just NewMessage {coord = Just ("D","7"), result = Just False, prev = Just NewMessage {coord = Just ("B","3"), result = Just False, prev = Just NewMessage {coord = Just ("D","5"), result = Just True, prev = Just NewMessage {coord = Just ("J","3"), result = Just True, prev = Just NewMessage {coord = Just ("J","6"), result = Just True, prev = Just NewMessage {coord = Just ("A","1"), result = Just False, prev = Just NewMessage {coord = Just ("E","5"), result = Just False, prev = Just NewMessage {coord = Just ("I","9"), result = Just False, prev = Just NewMessage {coord = Just ("I","1"), result = Just True, prev = Just NewMessage {coord = Just ("J","7"), result = Just False, prev = Just NewMessage {coord = Just ("E","1"), result = Just False, prev = Just NewMessage {coord = Just ("G","9"), result = Just False, prev = Just NewMessage {coord = Just ("D","9"), result = Just False, prev = Just NewMessage {coord = Just ("B","6"), result = Just True, prev = Just NewMessage {coord = Just ("B","1"), result = Just True, prev = Just NewMessage {coord = Just ("J","2"), result = Just False, prev = Just NewMessage {coord = Just ("C","8"), result = Just False, prev = Just NewMessage {coord = Just ("C","2"), result = Just True, prev = Just NewMessage {coord = Just ("J","2"), result = Just False, prev = Just NewMessage {coord = Just ("C","5"), result = Just False, prev = Just NewMessage {coord = Just ("H","5"), result = Just True, prev = Just NewMessage {coord = Just ("B","4"), result = Just False, prev = Just NewMessage {coord = Just ("B","7"), result = Just False, prev = Just NewMessage {coord = Just ("B","5"), result = Just False, prev = Just NewMessage {coord = Just ("F","10"), result = Just True, prev = Just NewMessage {coord = Just ("J","4"), result = Just False, prev = Just NewMessage {coord = Just ("D","6"), result = Just False, prev = Just NewMessage {coord = Just ("A","5"), result = Just True, prev = Just NewMessage {coord = Just ("F","8"), result = Just False, prev = Just NewMessage {coord = Just ("G","2"), result = Just False, prev = Just NewMessage {coord = Just ("D","10"), result = Just False, prev = Just NewMessage {coord = Just ("G","5"), result = Just True, prev = Just NewMessage {coord = Just ("E","6"), result = Just False, prev = Just NewMessage {coord = Just ("D","2"), result = Just False, prev = Just NewMessage {coord = Just ("I","7"), result = Just False, prev = Just NewMessage {coord = Just ("F","4"), result = Just False, prev = Just NewMessage {coord = Just ("G","1"), result = Just False, prev = Just NewMessage {coord = Just ("G","10"), result = Just False, prev = Just NewMessage {coord = Just ("G","5"), result = Just False, prev = Just NewMessage {coord = Just ("G","8"), result = Just False, prev = Just NewMessage {coord = Just ("I","6"), result = Just False, prev = Just NewMessage {coord = Just ("G","6"), result = Nothing, prev = Nothing}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}
        ]

formResult :: Message -> Either String (Maybe Message)
formResult msg = Right $ Just msg